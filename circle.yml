#
# Archivo de configuracion del servicio de integraci√≥n continua circleci
#

machine:
  pre:
    - curl -sSL https://s3.amazonaws.com/circle-downloads/install-circleci-docker.sh | bash -s -- 1.10.0
  timezone: America/Bogota
  services:
    - docker
  python:
# version de python del sistema base de CI, se requiere por ansible en 2.7
    version: 2.7.10
  post:
# versiones de python contra los cuales se probara el producto.
    - pyenv global 2.7.10 3.4.4 3.5.2

dependencies:
  pre:
    - pip install invoke
    - pip install ansible
#    - apt-get install python3.4-venv
  override:
#    - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
    - pip install tox 
    - pip install tox-pyenv
# crear ambientes virtuales y sus dependencias (~ inv virtual;inv deps)
    - tox -e py27,py34,py35 --notest

test:
  pre:
#    - invoke pre_commit
#    - invoke lint
  override:
#    - invoke test
    - tox -e py27,py34,py35
#    - invoke dist
    - invoke doc
  post:
    - cp build/test/results.* $CIRCLE_TEST_REPORTS
    - cp results.log $CIRCLE_ARTIFACTS
    - cp -r build/coverage $CIRCLE_ARTIFACTS
    - cp -r build/lint $CIRCLE_ARTIFACTS
    - cp -r build/doc $CIRCLE_ARTIFACTS
    - cp -r dist $CIRCLE_ARTIFACTS
