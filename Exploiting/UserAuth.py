from requests import get

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate, br",
    "Cookie": "Cisco_DeviceManager=value; varCook=varCook; gettingstarted=1; 172.16.2.10ga=false",
    "Connection": "close",
    "Authorization": "Basic Y2lzY286Y2lzY28=",
}

vulnerable = False
print "[+] Probando autenticacion para el usuario: 'cisco:cisco'"
print ""
res = get("https://172.16.2.10/", headers=headers, verify=False)
if res.status_code == 200:
  print "  Usuario autenticado (%d)" % res.status_code
  vulnerable = True
else:
  if res.status_code != 401:
    print "  ERROR (%d)" % res.status_code
    exit(0)
  else:
    print "  Usuario NO autenticado (%d)" % res.status_code

print ""
if vulnerable == True:
  print "VULNERABLE"
else:
  print "NO VULNERABLE"

