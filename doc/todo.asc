= TODO
:lang:		es
:author:	Enginering Team
:email:		engineering@fluid.la
:revnumber:	v1.0
:revdate:	{date}

== Funcionalidades

. http://dl.acm.org/citation.cfm?id=2896929 Automatic web security unit
  testing: XSS vulnerability detection

== Errores

. Solucionar los problemas de compilacion de YAML en CircleCI no ocurren, pero
  en los ambientes normales si

. Resolver los warnings de compilación de YAML (quitar YAML?)
  https://www.atlassian.com/git/tutorials/git-hooks/

. La generacion de txt de la documentación sale con errores de visualicion en
  caracteres extraños al parecer son problemas de codificación.

== Dependencias

. El venv solo funciona bien en ubuntu, a andrew le toco hacer un hack para que
  funcione en version 3.5 y en sid, posiblemente sea mejor trabajar asi:
  instalar python en el sistema, el que sea, y luego desde pip instalar el venv
  para poder forzar el uso de una version particular con ==

. Las dependencias de desarrollo deberian ser otras a las dependencias de
  ejecucion, por tal motivo deben existir dos archivos de requirements, uno
  para desarrollo y otro para ejecucion: requirements-dev.txt?

. Ya esta la dependencia en ubuntu6 de libffi??

. requirements.txt a docker-py??

. Separar la configuración que se encuentra en el codigo seleccionando una de
las siguientes bibliotecas:
https://bitbucket.org/ruamel/yaml
http://www.voidspace.org.uk/python/configobj.html
https://docs.python.org/3/library/configparser.html
https://pypi.python.org/pypi/python-decouple
https://github.com/osantana/prettyconf
https://github.com/ssato/python-anyconfig
https://bitbucket.org/dhagrow/profig/

== Versionamiento

. Definir en la nueva documentación el nuevo workflow de trabajo simplificado
. Sera que toco hacer esto por la nueva forma de crear el branch:
  $ git branch --set-upstream-to=origin/master ralvarez

. Donde estoy en GIT
  $ git --no-pager log --graph --oneline --decorate --date=relative --all -10

. Contar algo antes de hacer el prune (nueva tarea?):
  $ git count-objects -v

. Mantenimiento al repositorio borrando ya los commits no asociados a un branch
  $ git gc --prune=now

. Si algunas ramas que estan remote y fueron sincronizadas localmente fueron
  eliminadas de remote, pueden purgarse localmente con:
  $ git remote prune origin

. Este comando parece que hace la limpieza local de ramas que ya no existen
  en remote???
  $ git fetch --all --prune

. Comandos a hacer localmente para eliminar la rama develop:
  $ git branch --set-upstream-to=origin/master ralvarez
  $ git branch -d develop
  $ git remote prune origin
  $ git gc --prune=now

== Estilo

. Reducir los errores de flake8

. Hay errores de flake8 que salen en el linting a traves de lint y esos mismos
  errores no salen en el linting que se dispara desde el pre-commit.

. Analizar la configuracion de pylint para ver si se puede personalizar en el
  Failed correspondiente, por determinado puntaje que logre el codigo

. Analizar cambio en la arquitectura de linters: frosted vs pyflakes
  https://github.com/klen/pylama

== Documentación

. Añadir que en el /etc/hosts se agregue una linea que contenga el nombre del
  contenedor de docker que se usara para todas las pruebas.

. Falta explicar en la documentación cuando hay que hacer push.

. Despues de la sección de registro y cuando se pasa a la sección de descarga,
  no se habla de como se hace el login o como son los pasos de git login
  preliminares.

. Clarificar que el requerimiento es que funcione pyinvoke y pyenv, punto,
  independiente del interprete de python. O clarificar en la documentacion el
  tema de los ambientes virtuales, las versiones, etc

. Sera mas facil clarificar que debe haber un commit por comentario y no muchos
  diff con muchos comentarios.

. Revisar la documentación generada por Sphinx a Alabaster

. Guia sobre como debe documentarse un commit
  https://wiki.openstack.org/wiki/GitCommitMessages

. Adicionar guia de como hacer commits por cada caracteristica particular y
  por ende como fragmentar varios cambios en varios commit:
  http://nuclearsquid.com/writings/git-add/
  http://alblue.bandlem.com/2011/10/git-tip-of-week-interactive-adding.html

== Pruebas

. Parametrizar pytest mediante seccion en tox.ini y no solo mediante parametros
  de comandos

. Eliminar los printf de los suite de pruebas y analizar la opcion de 
  invocar con menos -s pytest y hacer log debug

. Analizar el uso de parametrized test para no tener 2 funciones para abierto
  y cerrado, sino solo una prueba que tenga parametrizadas las dos opciones

. Permitir la instalación de este modulo para la ejecución de comandos
  individuales https://github.com/dstanek/tox-run-command

. Debido al uso de docker y de comunicación entre servidores a veces no
  funciona las pruebas de unidad por problemas de comunicación con el host o
  timeout.

. Incoportar en la suite de integracion las pruebas que hacen funcionar docker
  y ansible.

. Pre.commit hooks in server side
  https://git-scm.com/book/en/v2/Customizing-Git-An-Example-Git-Enforced-Policy

. Volver a revisar tox o doit como herramientas de integracion
https://testrun.org/tox/latest/

. Tox testing para multiples versiones de python:
  https://discuss.circleci.com/t/testing-in-different-environments/450/2
  https://discuss.circleci.com/t/testing-with-multiple-python-versions/4420

. Pruebas unitarias de los mensajes de error en los logs?
  https://pypi.python.org/pypi/pytest-capturelog

. Hacer refactoring de las suites de pruebas para que sean menos
  repetitivas:
  http://doc.pytest.org/en/latest/parametrize.html

. Testing de multiples versiones de python en circleci
  https://ben.fogbutter.com/2016/02/20/testing-multiple-python-versions-on-circleci.html

. Crear archivo de configuracion de coverage que permita ademas de centralizar
  los parametros de configuracion de la aplicacion, establecer una meta
  de coverage antes de fallar:
  https://coverage.readthedocs.io/en/latest/config.html

== Construccion

. Porque iniciar el container es tan lento si ya tenemos la imagen con los
  paquetes listos.

. Acelerar la ejecución de las pruebas:
.. Considerando ssh pipelining
.. Deshabibilitando los facters
.. Habilitando el profile de ansible
.. Reorganizando en roles o con tags para que no se repitan tareas.
... instalar - provision
... config??
... hack
... harden
... desintarlar

. Migrar las tareas de tasks a tox.ini

. Entre el import sorter de precommit y flake8 se contradicen.

. Adicionar verificación que no permite que el software se ejecute como *root*.

. Adicionar cloc en el proceso de integracion continua y build

. Definir commandos para commit, pull request, etc en los archivos de
  construccion??

. Utilizar el API de ansible para hacer test de asserts propios al sistema
  operativo???

. o en su efecto utilizar TestInfra http://testinfra.readthedocs.io/en/latest/

. Crear una imagen docker de FLUIDAsserts

. O con docker compose:
  http://www.heavybit.com/library/blog/opinionated-tour-of-testing-tools/

. Tasks que manehen el deployment

. Forzar con Collections en PyInvoke el LANG:
  $ export LANG=C

. La generación de artifacts en CI no invoca la generación de la documentación
  que se genera con asciidoc

. El buildlog de CI no invoca aun el task de size que hace cloc, posiblemente
  necesita la dependencia

== Empaquetamiento

. Revisar que se genera con tox un archivo en la raiz que se llama MANIFEST

. Mover el fuente de empaquetamiento a un lugar diferente del raiz? conf?

. Las dependencias manejarlas en requirements separados y en otro lugar, tox 
  ayuda

. Añadir soporte de Wheel

. Paquete especificado con setup.py o setup.cfg? uno de los dos? ambos son
  necesarios?

. Utilizar para el empaquetamiento distutils o distutils2 (packaging)

. Revisar la pertinencia del API de Mocks
  https://docs.python.org/dev/library/unittest.mock.html

. Revisar el mock de http con: https://github.com/gabrielfalcao/HTTPretty
  (problemas con python3)

. Mover el fuente de fluidasserts a src, revisar en detalle este documento:
https://blog.ionelmc.ro/2014/05/25/python-packaging/

== Productos

. Historico de cobertura con: https://coveralls.io/

. Historico de calidad de codigo: https://codeclimate.com/

. Integracion continua en Windows: https://www.appveyor.com/

. Deploy a heroku

. Analizar el compliance con TAP como protocolo de salida estandar:
http://testanything.org/

== Virtualización

. Convertir los scripts de construcción de la imagen a Makefile y posiblemente
  simplificarlos a un solo archivo inspirado en el Makefile sobre la imagen
  de debian en la que esta basada la construcción del sistema.
https://hub.docker.com/r/krlmlr/debian-ssh/

. Poner un trabajo para que las imagenes se construyan solas en docker-hub.
https://docs.docker.com/engine/tutorials/dockerrepos/#/automated-builds

. En circleci hacer que baje el docker image y no que le toque construirlo.

. Verificar si ansible en ves de ser una dependencia del SO, puede quedar
  como una dependencia de requierements-test.txt y que se instale solo
  en dicho escenario en el ambiente virtual.

. El modulo apt de ansible siempre va a internet a jalar archivos, la unica
  opcion no probada es esta de apt-cacher-ng-offline, la no offline requiere
  correr un servicio apache localmente o tener otro docker.
https://lostechies.com/ryanrauh/2015/01/28/how-to-easily-apt-get-update-offline/
http://askubuntu.com/questions/306971/install-package-along-with-all-the-dependencies-offline
https://help.ubuntu.com/community/AptGet/Offline/Repository/

. Utilizar el modulo async de ansible para ejecución paralela de tasks.

. Se generan con ansible archivos .retry.  O gitignore o Clean o no generarlos

. Los fixtures solo ejecutan los tags vulnerable y no vulnetable, por ende no
  corren los playbooks de debian (base) ni los tanks sin tag.  Estas dos son
  dependencias criticas para la ejecución del playbook.

. Adicionar soporte para medir la longitud de las tareas
  https://github.com/jlafon/ansible-profile

. El docker de la integración continua es 1.9 y el de ubuntu 14 y muy
  posiblemente las demas maquinas de desarrollao es 1.10 a 1.12.  Esto implica
  que algunos comandos de red no estan disponibles y por ende pueden fallar en
  la integración continua. Hay que analizar hacer downgrade en las maquinas
  locales, o puede ser que con docker compose el problema se abstraiga.
  https://github.com/weaveworks/weave/issues/2420
  http://stackoverflow.com/questions/34813343/what-method-docker-use-to-give-container-an-ip-address

. En vez de utilizar los scripts de inicio de docker, puede que docker compose
  facilite el inicio y fin de los diferentes servidores de docker asi como
  las especificación de las interfaces de red correspondientes.
http://stackoverflow.com/questions/31787426/can-circle-ci-use-docker-compose-to-build-the-environment
https://www.theodo.fr/blog/2016/05/straight-to-production-with-docker-ansible-and-circleci/

. Este wrapper permite manejar ambientes virtuales de python ya sea pyvenv o
  virtualenv, parece en inicio mas maduro que los otros
  http://pyvenvwrapper.readthedocs.io/en/latest/index.html tiene la ventaja de
  poder ser instalado via pip y por ende hacerlo mas independiente del
  empaquetamiento propio del sistema local

. Analizar si continuar con ansible o hacer algunas modificaciones desde
  fabric.  Actualmente el problema radica que fabric no funciona en Python3 o
  hay solo un fork que se encarga de esto 
  https://github.com/mathiasertl/fabric/
  https://insights.sei.cmu.edu/devops/2015/03/devops-technologies-fabric-or-ansible.html

include::include/footer.adoc[]
