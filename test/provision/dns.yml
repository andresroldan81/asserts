---
- name: Configure container with bind9 
  hosts: container 
  become: yes 
  vars:
        conf_zone: /etc/bind/named.conf.local
        test_zone: /var/cache/bind/db.test
        zone_domain: fluid.la 
  tasks:
        - name: Install bind9 
          apt: name=bind9 update_cache=yes cache_valid_time=3600
          tags: basic

        - name: Copy zone 
          copy: src=dns/db.test dest={{ test_zone }} owner=bind mode=0644
          notify: restart bind9 
          tags: basic 

# tag: weak
# DNS inseguro 
#
        - name: Copy weak zone config 
          template: src=dns/named.conf.local.weak.j2 owner=bind dest={{ conf_zone }}
          notify: restart bind9 
          tags: weak 

# tag: hard 
# DNS seguro
#
        - name: Copy hard zone config 
          template: src=dns/named.conf.local.hard.j2 owner=bind dest={{ conf_zone }}
          notify: restart bind9 
          tags: hard

  handlers:
        - name: restart bind9 
          service: name=bind9 state=restarted
