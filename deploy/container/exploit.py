from fluidasserts.lang import python
from fluidasserts.lang import docker
from fluidasserts.sca import pypi

ASSERTS_DIRS = ['fluidasserts', 'test']
DOCKERFILES = ['Dockerfile.builder', 'Dockerfile.base', 'Dockerfile.runner']
EXCLUDED_DIRS = ['test/static']

for adir in ASSERTS_DIRS:
    python.swallows_exceptions(adir, EXCLUDED_DIRS)
    python.has_generic_exceptions(adir, EXCLUDED_DIRS)

for dockerfile in DOCKERFILES:
    docker.not_pinned(dockerfile)
pypi.project_has_vulnerabilities('.')
